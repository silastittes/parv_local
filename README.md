## Analyses pipelines and scripts for ["Not so local: the population genetics of convergent adaptation in maize and teosinte"](https://www.biorxiv.org/content/10.1101/2021.09.09.459637v1).


The majority of analyses-ready data is generated by `./Snakefile`.

While the paths are all local, to re-run analyses, the sequence and processed data must first be made available.
[All processed data used for figures and analyses can be downloaded here.](https://datacommons.cyverse.org/browse/iplant/home/aseetharam/B73v5-deduped-alignments). Note, the entirety of this directoy should be places in the path `./data`, exlucuding the cyverse parent directoy `parv_local_data `. For example, the pairwise diversity (pi) files should have the relative path `./data/angsd_pi/v5--LR--Amatlan_de_Canas--chr1--0--308452471.1000BP_theta.thetasWindow.gz.pestPG`. This will ensure the files can be correctly accessed in the jupyter notebooks located in `./notebooks` directory. 

For reproducing from scratch, [The bam files can be downloaded here.](https://datacommons.cyverse.org/browse/iplant/home/aseetharam/B73v5-deduped-alignments) In order for downstream analyses to see the bam files, that should be places in this repository under the path`./data/bams/v5-alignments/deduped-bam/`.

(TO DO: LINK TO SRA).

All computation was done using the UC DAVIS farm HPC. Many aspects of the compute configuation assumes farm is being used, so a complete reproduction of the analysis will require some manual changes to the configurations found in `./submit.json`. 

Simulations concerning the relationship between diviersity ($\theta$) and proportion of new mutations fixed by natural selection ($\alpha$) are in `./dfe_and_alpha_slim/`. Nextflow was used to run these simulations rather than Snakemake, which was used for all other analyses.  

The RDMC analyses were created using a separate pipeline `RDMC.smk`, though both the main pipeline and the RDMC pipeline can be ran using `submit.sh`

Figures and analyses can be reproduced using the Jupyter `./notebooks/`. A yaml file to recreate the necessary dependencies for these notebooks is `r-environment.yml`


